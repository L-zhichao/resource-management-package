(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b99da8d0"],{1276:function(e,t,r){"use strict";var i=r("d784"),n=r("44e7"),s=r("825a"),a=r("1d80"),o=r("4840"),l=r("8aa5"),u=r("50c4"),m=r("14c3"),c=r("9263"),p=r("d039"),g=[].push,d=Math.min,f=4294967295,h=!p((function(){return!RegExp(f,"y")}));i("split",2,(function(e,t,r){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var i=String(a(this)),s=void 0===r?f:r>>>0;if(0===s)return[];if(void 0===e)return[i];if(!n(e))return t.call(i,e,s);var o,l,u,m=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,h=new RegExp(e.source,p+"g");while(o=c.call(h,i)){if(l=h.lastIndex,l>d&&(m.push(i.slice(d,o.index)),o.length>1&&o.index<i.length&&g.apply(m,o.slice(1)),u=o[0].length,d=l,m.length>=s))break;h.lastIndex===o.index&&h.lastIndex++}return d===i.length?!u&&h.test("")||m.push(""):m.push(i.slice(d)),m.length>s?m.slice(0,s):m}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var n=a(this),s=void 0==t?void 0:t[e];return void 0!==s?s.call(t,n,r):i.call(String(n),t,r)},function(e,n){var a=r(i,e,this,n,i!==t);if(a.done)return a.value;var c=s(e),p=String(this),g=o(c,RegExp),b=c.unicode,v=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(h?"y":"g"),w=new g(h?c:"^(?:"+c.source+")",v),F=void 0===n?f:n>>>0;if(0===F)return[];if(0===p.length)return null===m(w,p)?[p]:[];var x=0,y=0,$=[];while(y<p.length){w.lastIndex=h?y:0;var I,R=m(w,h?p:p.slice(y));if(null===R||(I=d(u(w.lastIndex+(h?0:y)),p.length))===x)y=l(p,y,b);else{if($.push(p.slice(x,y)),$.length===F)return $;for(var _=1;_<=R.length-1;_++)if($.push(R[_]),$.length===F)return $;y=x=I}}return $.push(p.slice(x)),$}]}),!h)},"44e7":function(e,t,r){var i=r("861d"),n=r("c6b6"),s=r("b622"),a=s("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==n(e))}},b017:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"新物品添加",visible:e.dialogVisible,"before-close":e.handleClose,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"名称",prop:"itemName"}},[r("el-input",{attrs:{type:"text",controls:!1},model:{value:e.ruleForm.itemName,callback:function(t){e.$set(e.ruleForm,"itemName",t)},expression:"ruleForm.itemName"}})],1),r("el-form-item",{attrs:{label:"数量",prop:"number"}},[r("el-input",{attrs:{type:"number",controls:!1,size:"mini",min:"1"},model:{value:e.ruleForm.number,callback:function(t){e.$set(e.ruleForm,"number",e._n(t))},expression:"ruleForm.number"}})],1),r("el-form-item",{attrs:{label:"单价金额",prop:"price"}},[r("el-input",{attrs:{type:"number",controls:!1,size:"mini",min:.01,step:.01,precision:"2"},model:{value:e.ruleForm.price,callback:function(t){e.$set(e.ruleForm,"price",e._n(t))},expression:"ruleForm.price"}})],1),r("el-form-item",{attrs:{label:"详情",prop:"description"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.description,callback:function(t){e.$set(e.ruleForm,"description",t)},expression:"ruleForm.description"}})],1),r("el-form-item",{attrs:{label:"视频图片",prop:"img"}},[r("el-upload",{ref:"img",attrs:{drag:"",action:"",accept:".png, .jpg, .jpeg, .mp4, .flv",limit:1,"list-type":"text","on-change":e.change,"on-exceed":e.handleExceed,"auto-upload":!1}},[r("i",{staticClass:"el-icon-upload"}),r("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),r("em",[e._v("点击上传")])]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传一个图片或视频文件")])])],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",loading:e.buttonLoading},on:{click:e.submit}},[e._v("确 定")])],1)],1)},n=[],s=(r("a4d3"),r("e01a"),r("c975"),r("b0c0"),r("a9e3"),r("d3b7"),r("ac1f"),r("5319"),r("1276"),r("96cf"),r("1da1")),a=r("365c"),o={name:"addNewItem",props:{dialogArouse:{type:Number,required:!0}},data:function(){return{ruleForm:{itemName:"",number:1,price:null,description:"",img:"",imgs:"",videos:""},imgType:null,rules:{itemName:[{required:!0,message:"请输入物品名",trigger:"blur"},{required:!0,pattern:/^[\u4e00-\u9fa5_a-zA-Z0-9\s*.·-]+$/,message:"不支持特殊字符",trigger:"blur"}],number:[{required:!0,message:"请输入数量",trigger:"blur"},{required:!0,pattern:/^[0-9|^\\.]/,message:"不能为负",trigger:"blur"}],price:[{required:!0,message:"请输入单价金额",trigger:"blur"},{required:!0,pattern:/^[0-9|^\\.]/,message:"不能为负",trigger:"blur"},{required:!0,pattern:/(^[1-9](\d+)?(\.\d{1,2})?$)|(^0$)|(^\d\.\d{1,2}$)/,message:"请输入正确格式",trigger:"blur"}],description:[{required:!0,message:"说明一下",trigger:"blur"}],img:[{required:!0,message:"上传视频或图片",trigger:"blur"}]},buttonLoading:!1,dialogVisible:!1}},watch:{dialogArouse:function(){this.dialogVisible=!0}},methods:{handleClose:function(e){var t=this;this.$confirm("确认关闭？").then((function(r){t.ruleForm={itemName:"",number:1,price:null,description:"",img:""},t.$refs.ruleForm.clearValidate(),t.$refs.img.clearFiles(),e()})).catch((function(e){}))},handleExceed:function(e,t){this.$message.error("最多上传1张图片")},beforeUpload:function(e){var t=e.name.replace(/.+\./,""),r=e.size/1024/1024<=30,i=-1===["png","jpg","jpeg","mp4","flv"].indexOf(t.toLowerCase());return i?(this.$message({type:"warning",message:"只能上传 .png, .jpg, .jpeg, .mp4, .flv 文件！"}),this.$refs.img.clearFiles(),!1):!!r||(this.$message({type:"warning",message:"附件大小超限，文件不能超过 30M"}),this.$refs.img.clearFiles(),!1)},previewFile:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var i,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:i=new Blob([e],{type:e.type}),n=null,e&&(n=new FileReader,n.readAsDataURL(i)),n.onload=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.ruleForm.img=n.result;case 1:case"end":return e.stop()}}),e)})));case 4:case"end":return r.stop()}}),r)})))()},pImg:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){e.onload=function(){var r=parseInt(e.width)/parseInt(e.height);t(r)}})));case 1:case"end":return t.stop()}}),t)})))()},pCanvas:function(e,t,r,i){return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,s){i.drawImage(e,0,0,t,500);var a=r.toDataURL();n(a)})));case 1:case"end":return n.stop()}}),n)})))()},imageCompression:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var i,n,s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return i=new Image,n=document.createElement("canvas"),s=n.getContext("2d"),i.src=e,r.next=6,t.pImg(i);case 6:return a=r.sent,n.width=500*a,n.height=500,r.next=11,t.pCanvas(i,500*a,n,s);case 11:return r.abrupt("return",r.sent);case 12:case"end":return r.stop()}}),r)})))()},itemAddAPI:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,i,n,s,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.itemName,i=e.number,n=e.price,s=e.description,o=e.imgs,l=e.videos,t.next=3,a["a"].ITEM_ADD_API({itemName:r,number:i,price:n,description:s,imgs:o,videos:l});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},itemAdd:function(e){var t=this,r=e.itemName,i=e.number,n=e.price,s=e.description,a=e.imgs,o=e.videos;this.itemAddAPI({itemName:r,number:i,price:n,description:s,imgs:a,videos:o}).then((function(e){if(null===e)t.$message({message:"上传成功",type:"success"}),t.ruleForm={itemName:"",number:1,price:null,description:"",imgs:"",videos:""},t.$refs.ruleForm.clearValidate(),t.$refs.img.clearFiles(),t.dialogVisible=!1,t.buttonLoading=!1,t.$emit("addSuccess");else if("fail"===e)t.$message.error("上传失败"),t.buttonLoading=!1;else if(e.status>=4e4)return t.$log.push({message:"错误代码:"+e.status+","+e.message,type:"warning"}),t.$notify({title:e.message,message:"错误代码:"+e.status,position:"bottom-left",type:"warning"})}))},imgUploadAPI:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a["a"].ITEM_IMG_UPLOAD_API(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},imgUpload:function(e){var t=this,r=new FormData;r.append("file",new Blob([e.raw],{type:e.raw.type})),this.buttonLoading=!0,this.imgUploadAPI(r).then((function(e){if("http:"===e.split("/")[0]||"https:"===e.split("/")[0])"image"===t.imgType?(t.ruleForm.imgs=e,t.ruleForm.videos=""):"video"===t.imgType&&(t.ruleForm.imgs="",t.ruleForm.videos=e),t.itemAdd({itemName:t.ruleForm.itemName,number:t.ruleForm.number,price:t.ruleForm.price,description:t.ruleForm.description,imgs:t.ruleForm.imgs,videos:t.ruleForm.videos});else if("fail"===e)t.$message.error("上传失败 || 返回数据有误"),t.buttonLoading=!1;else if(e.status>=4e4)return t.$log.push({message:"错误代码:"+e.status+","+e.message,type:"warning"}),t.$notify({title:e.message,message:"错误代码:"+e.status,position:"bottom-left",type:"warning"})}))},change:function(e,t){this.beforeUpload(e,t)&&(this.ruleForm.img=e,"image"===e.raw.type.split("/")[0]?this.imgType="image":"video"===e.raw.type.split("/")[0]&&(this.imgType="video"))},submit:function(){var e=this;this.$refs.ruleForm.validate((function(t){t?e.imgUpload(e.ruleForm.img):e.$message.error("表单校验失败，请检查")}))}}},l=o,u=r("2877"),m=Object(u["a"])(l,i,n,!1,null,"69660350",null);t["default"]=m.exports}}]);