(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-accb567c","chunk-2d209225","chunk-2d0b6386"],{"099f":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-drawer",{attrs:{title:"新物品购置资金请求",visible:e.drawerVisible,size:"80%",direction:"btt","before-close":e.handleClose},on:{"update:visible":function(t){e.drawerVisible=t}}},[e.userAdministratorPermissions?a("el-radio-group",{style:{marginLeft:"16px"},attrs:{size:"small"},on:{input:e.radioChange},model:{value:e.radio.admin,callback:function(t){e.$set(e.radio,"admin",t)},expression:"radio.admin"}},[a("el-radio-button",{attrs:{label:"未处理"}}),a("el-radio-button",{attrs:{label:"已处理"}})],1):e._e(),e.userAdministratorPermissions?e._e():a("el-radio-group",{style:{marginLeft:"16px"},attrs:{size:"small"},on:{input:e.radioChange},model:{value:e.radio.ordinary,callback:function(t){e.$set(e.radio,"ordinary",t)},expression:"radio.ordinary"}},[a("el-radio-button",{attrs:{label:"我的"}}),a("el-radio-button",{attrs:{label:"全部"}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadAnimation,expression:"loadAnimation"}],key:e.randomKey,staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"applyTime",label:"申请时间",width:"180"}}),"全部"===e.radio.ordinary||e.userAdministratorPermissions?a("el-table-column",{attrs:{prop:"applyUser",label:"申请人",width:"140"}}):e._e(),a("el-table-column",{attrs:{prop:"content",label:"申请内容"}}),a("el-table-column",{attrs:{prop:"money",label:"申请总金额",width:"140"}}),a("el-table-column",{attrs:{label:"状态",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[0!==t.row.state||e.userAdministratorPermissions?e._e():a("el-button",{attrs:{size:"small",disabled:""}},[e._v("未处理")]),0===t.row.state&&e.userAdministratorPermissions?a("el-popover",{key:e.randomKeyPopover,attrs:{placement:"left",width:"550",trigger:"click"},on:{show:function(a){return e.ruleFormData(t)},hide:e.ruleFormClear}},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",[[a("el-radio",{attrs:{size:"small",border:"",label:1},model:{value:e.radioDispose,callback:function(t){e.radioDispose=t},expression:"radioDispose"}},[e._v("批准")]),a("el-radio",{attrs:{size:"small",border:"",label:2},model:{value:e.radioDispose,callback:function(t){e.radioDispose=t},expression:"radioDispose"}},[e._v("不批准")])]],2),a("el-form-item",{attrs:{label:"说明",prop:"reason"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.reason,callback:function(t){e.$set(e.ruleForm,"reason",t)},expression:"ruleForm.reason"}})],1)],1),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submit}},[e._v(e._s(1===e.radioDispose?"批准":"不批准"))])],1),a("el-button",{attrs:{slot:"reference",type:"primary",size:"small"},slot:"reference"},[e._v("待处理")])],1):e._e(),a("el-popover",{attrs:{placement:"left",width:"800",trigger:"hover"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadAnimationResponse,expression:"loadAnimationResponse"}],key:e.randomKeyResponse,staticStyle:{width:"100%"},attrs:{data:e.tableDataResponse}},[a("el-table-column",{attrs:{prop:"responseTime",label:"回应时间",width:"180"}}),a("el-table-column",{attrs:{prop:"responseUser",label:"回应人",width:"140"}}),a("el-table-column",{attrs:{prop:"reason",label:"回应说明"}})],1),a("template",{slot:"reference"},[a("div",[1===t.row.state?a("el-button",{attrs:{size:"small",type:"success"},nativeOn:{mouseover:function(a){return e.tableDataResponseChange(t.row.applyId)}}},[e._v("已通过")]):e._e(),2===t.row.state?a("el-button",{attrs:{size:"small",type:"danger"},nativeOn:{mouseover:function(a){return e.tableDataResponseChange(t.row.applyId)}}},[e._v("未通过")]):e._e()],1)])],2)]}}])})],1)],1)},n=[],i=(a("4de4"),a("4160"),a("a9e3"),a("ac1f"),a("1276"),a("159b"),a("53ca")),s=(a("96cf"),a("1da1")),o=a("c276"),l=a("365c"),u=a("5a0c"),m=a.n(u),c={name:"showNewItem",props:{drawerArouse:{type:Number,required:!0}},data:function(){return{tableData:[{applyId:0,applyTime:"2023-12-14 13:14:15",applyUser:"User",content:"原神2个:不玩原神的人，后面忘了",money:0,state:1}],tableDataResponse:[{applyId:0,responseTime:"2023-12-15 13:14:15",responseUser:"XJ",reason:"原神,启动!"}],allTableData:[[[],[]],[[],[]]],radio:{admin:"未处理",ordinary:"我的"},ruleForm:{applyId:null,applyName:"",result:2,reason:"",money:0},rules:{reason:[{required:!0,message:"请求回应为必填",trigger:"blur"}]},radioDispose:1,randomKey:Math.random(),randomKeyResponse:Math.random(),randomKeyPopover:Math.random(),loadAnimation:!1,loadAnimationResponse:!1,drawerVisible:!1,userAdministratorPermissions:"0"===o["a"].cookies.get("userStatus")||!1}},watch:{drawerArouse:function(){this.itemShowApply(),this.drawerVisible=!0},radioDispose:function(e){1===e?this.ruleForm.result=2:2===e&&(this.ruleForm.result=0)}},methods:{handleClose:function(e){e(),this.tableData=[],this.tableDataResponse=[],this.allTableData=[[[],[]],[[],[]]],this.radio={admin:"未处理",ordinary:"我的"}},radioChange:function(){this.userAdministratorPermissions?"未处理"===this.radio.admin?this.tableData=this.allTableData[0][0]:this.tableData=this.allTableData[0][1]:"我的"===this.radio.ordinary?this.tableData=this.allTableData[1][0]:this.tableData=this.allTableData[1][1]},tableDataResponseChange:function(e){var t=this;this.tableData.forEach((function(a,r){a.applyId===e&&(t.tableDataResponse[0]=a,t.userAdministratorPermissions||-1!==a.status||a.applyUser!==o["a"].cookies.get("name")||(t.itemReadResponse({id:e}),t.allTableData[1][0].forEach((function(a,r){a.applyId===e&&(t.allTableData[1][0][r].status=1)})),t.allTableData[1][1].forEach((function(a,r){a.applyId===e&&(t.allTableData[1][1][r].status=1)})))),t.randomKeyResponse=Math.random()}))},itemResponseAPI:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n,i,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.applyId,r=e.applyName,n=e.result,i=e.reason,s=e.responseTime,o=e.responseName,t.next=3,l["a"].ITEM_RESPONSE_API({applyId:a,applyName:r,result:n,reason:i,responseTime:s,responseName:o});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},itemResponse:function(e){var t=this,a=e.applyId,r=e.applyName,n=e.result,s=e.reason,l=m()().format("YYYY-MM-DD HH:mm:ss"),u=o["a"].cookies.get("name");this.itemResponseAPI({applyId:a,applyName:r,result:n,reason:s,responseTime:l,responseName:u}).then((function(e){if("object"===Object(i["a"])(e))t.ruleForm={applyId:null,applyName:"",result:2,reason:"",money:0},t.radioDispose=1,t.randomKeyPopover=Math.random(),t.$refs.ruleForm.clearValidate(),t.$message({message:"回应上传成功",type:"success"}),t.loadAnimation=!0,t.itemShowApply();else if("fail"===e)t.$message.error("上传失败");else if(e.status>=4e4)return t.$log.push({message:"错误代码:"+e.status+","+e.message,type:"warning"}),t.$notify({title:e.message,message:"错误代码:"+e.status,position:"bottom-left",type:"warning"})}))},itemReadResponseAPI:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.applyId,t.next=3,l["a"].ITEM_READ_RESPONSE_API({applyId:a});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},itemReadResponse:function(e){var t=e.id;this.itemReadResponseAPI({applyId:t})},itemShowApplyAPI:function(){return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["a"].ITEM_SHOW_APPLY_API();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()},itemShowApply:function(){var e=this;this.tableData=[],this.tableDataResponse=[],this.allTableData=[[[],[]],[[],[]]],this.radio={admin:"未处理",ordinary:"我的"},this.itemShowApplyAPI().then((function(t){if("undefined"===typeof t[0])return e.$message({message:"没有任何物品申请"});"applyId"in t[0]?(t.forEach((function(t,a){e.allTableData[1][1].push(JSON.parse(JSON.stringify(t))),e.allTableData[1][1][e.allTableData[1][1].length-1].content=t.content.split("//////////")[0]+" × "+t.content.split("//////////")[1]+": "+t.content.split("//////////")[2],-1===t.status?e.allTableData[1][1][e.allTableData[1][1].length-1].state=0:e.allTableData[1][1][e.allTableData[1][1].length-1].state=3})),e.itemShowResponse()):e.$message.error("物品申请信息请求失败")}))},fundsVoFundsVoAPI:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l["a"].FUNDSVO_FUNDSVO_API(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},fundsVoFundsVo:function(e){var t=this;this.fundsVoFundsVoAPI(e).then((function(e){e.assetValue-=t.ruleForm.money,t.fundsVoUpData(e)}))},fundsVoUpDataAPI:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l["a"].FUNDSVO_UNDATE_API(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},fundsVoUpData:function(e){this.fundsVoUpDataAPI(e)},itemShowResponseAPI:function(){return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["a"].ITEM_SHOW_RESPONSE_API();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()},itemShowResponse:function(){var e=this;this.itemShowResponseAPI().then((function(t){if("undefined"===typeof t[0])return e.allTableData[1][0]=e.allTableData[1][1].filter((function(e,t){if(e.applyUser===o["a"].cookies.get("name"))return e})),e.allTableData[0][0]=e.allTableData[1][1].filter((function(e,t){if(-1===e.status)return e})),e.allTableData[0][1]=e.allTableData[1][1].filter((function(e,t){if(-1!==e.status)return e})),e.userAdministratorPermissions?"未处理"===e.radio.admin?e.tableData=e.allTableData[0][0]:e.tableData=e.allTableData[0][1]:"我的"===e.radio.ordinary?e.tableData=e.allTableData[1][0]:e.tableData=e.allTableData[1][1],void setTimeout((function(){e.loadAnimation=!1}),300);if("applyId"in t[0]){var a=JSON.parse(JSON.stringify(e.allTableData[1][1]));t.forEach((function(t,r){a.forEach((function(a,r){t.applyId===a.applyId&&3===a.state&&(e.allTableData[1][1][r].responseTime=t.responseTime,e.allTableData[1][1][r].responseUser=t.responseUser,e.allTableData[1][1][r].reason=t.reason,e.allTableData[1][1][r].state=2===t.result?1:2,e.allTableData[1][1][r].status=t.status)}))})),e.allTableData[1][0]=e.allTableData[1][1].filter((function(e,t){if(e.applyUser===o["a"].cookies.get("name"))return e})),e.allTableData[0][0]=e.allTableData[1][1].filter((function(e,t){if(0===e.state)return e})),e.allTableData[0][1]=e.allTableData[1][1].filter((function(e,t){if(0!==e.state)return e})),e.userAdministratorPermissions?"未处理"===e.radio.admin?e.tableData=e.allTableData[0][0]:e.tableData=e.allTableData[0][1]:"我的"===e.radio.ordinary?e.tableData=e.allTableData[1][0]:e.tableData=e.allTableData[1][1],setTimeout((function(){e.loadAnimation=!1}),300)}else e.$message.error("物品回应信息请求失败")}))},ruleFormClear:function(){this.ruleForm={applyId:null,applyName:"",result:2,reason:"",money:0},this.radioDispose=1,this.$refs.ruleForm.clearValidate()},ruleFormData:function(e){var t=this;console.log(e),setTimeout((function(){t.radioDispose=1,t.ruleForm={applyId:e.row.applyId,applyName:e.row.applyUser,result:2,reason:"",money:e.row.money}}),30)},submit:function(){var e=this;this.$refs.ruleForm.validate((function(t){t?(1===e.radioDispose&&e.fundsVoFundsVo(0x176f9154112b3000),e.itemResponse({applyId:e.ruleForm.applyId,applyName:e.ruleForm.applyName,result:e.ruleForm.result,reason:e.ruleForm.reason})):e.$message.error("表单校验失败，请检查")}))}}},d=c,p=a("2877"),g=Object(p["a"])(d,r,n,!1,null,"5e0b6496",null);t["default"]=g.exports},"1bdc":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{key:e.randomKey,attrs:{visible:e.dialogVisible,width:"80%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("video",{staticClass:"video",attrs:{codecs:"avc1.42E01E, mp4v.20.8, mp4v.20.240, avc1.66.30, mp4a.40.2",controls:"",width:"100%"}},[a("source",{attrs:{src:e.playerVideoUrl,type:"video/mp4"}})])])},n=[],i={name:"videoPlayer",props:{dialogVideoPlayer:{required:!0},videoUrl:{required:!0}},data:function(){return{randomKey:Math.random(),playerVideoUrl:"",dialogVisible:!1}},watch:{dialogVideoPlayer:function(){this.playerVideoUrl=this.videoUrl,this.dialogVisible=!0}},methods:{handleClose:function(e){this.playerVideoUrl="",this.randomKey=Math.random(),e()}}},s=i,o=a("2877"),l=Object(o["a"])(s,r,n,!1,null,"4ed9ca60",null);t["default"]=l.exports},"2e5a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[a("template",{slot:"header"},[a("el-row",{attrs:{gutter:20,type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:2.5}},[e.userAdministratorPermissions?a("el-button-group",[a("el-tooltip",{attrs:{content:"查看新物品购置资金请求",placement:"bottom"}},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){e.drawerNewItemArouseChangesNumber++}}},[e._v(" 申请信息 ")])],1),a("el-tooltip",{attrs:{content:"查看物品损坏信息",placement:"bottom"}},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){e.drawerOldItemArouseChangesNumber++}}},[e._v(" 损坏信息 ")])],1)],1):e._e(),e.userAdministratorPermissions?e._e():a("el-button-group",[a("el-tooltip",{attrs:{content:"新物品购置资金申请",placement:"bottom"}},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){e.dialogNewItemArouseChangesNumber++}}},[e._v(" 物品申请 ")])],1),a("el-tooltip",{attrs:{content:"物品损坏上报",placement:"bottom"}},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){e.dialogOldItemArouseChangesNumber++}}},[e._v(" 损坏上报 ")])],1)],1)],1),a("el-col",{attrs:{span:9}},[a("el-input",{ref:"inputSearch",attrs:{placeholder:"请输入搜索内容"},on:{change:function(t){return e.handleCurrentChange(1)},focus:function(t){return e.inputFocus("inputSearch")}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchEnter("inputSearch")}},model:{value:e.inputSearch,callback:function(t){e.inputSearch=t},expression:"inputSearch"}})],1),a("el-col",{attrs:{span:2.5}},[e.userAdministratorPermissions?a("el-tooltip",{attrs:{content:"添加物品 | 很简单对吧?",placement:"bottom"}},[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){e.addNewItemArouseChangesNumber++}}},[e._v(" 添加新物品 ")])],1):e._e(),e.userAdministratorPermissions?e._e():a("el-tooltip",{attrs:{content:"看看你以前上报了什么??",placement:"bottom"}},[a("el-button-group",[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){e.drawerNewItemArouseChangesNumber++}}},[e._v(" 物品申请历史 ")]),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){e.drawerOldItemArouseChangesNumber++}}},[e._v(" 损坏上报历史 ")])],1)],1)],1)],1)],1),a("itemTable",{attrs:{tableData:e.tableData,randomKey:e.randomKey,loadAnimation:e.loadAnimation},on:{dialogOldItem:e.dialogOldItem,deleteInformation:e.deleteInformation,dialogChangeItem:e.dialogChangeItem,dialogVideoPlayerArouse:e.dialogVideoPlayerArouse}}),a("template",{slot:"footer"},[a("el-row",{staticClass:"row-bg",attrs:{gutter:20,type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.pagination.currentPage,"page-size":e.pagination.pageSize,"page-sizes":[5,10,20,30],layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.allData},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.pagination,"currentPage",t)},"update:current-page":function(t){return e.$set(e.pagination,"currentPage",t)}}})],1)])],1)],1),a("showNewItem",{attrs:{drawerArouse:e.drawerNewItemArouseChangesNumber}}),a("showDamageItem",{attrs:{drawerArouse:e.drawerOldItemArouseChangesNumber}}),a("applyNewItem",{attrs:{dialogArouse:e.dialogNewItemArouseChangesNumber}}),a("damageItemReport",{attrs:{dialogArouse:e.dialogOldItemArouseChangesNumber,oldItemId_Name:e.oldItemId_Name}}),a("addNewItem",{attrs:{dialogArouse:e.addNewItemArouseChangesNumber},on:{addSuccess:e.addSuccess}}),a("changeItem",{attrs:{dialogArouse:e.dialogChangeItemArouseChangesNumber,changeItemInformation:e.changeItemInformation},on:{changeItemSuccess:e.changeItemSuccess,dialogVideoPlayerArouse:e.dialogVideoPlayerArouse}}),a("videoPlayer",{attrs:{dialogVideoPlayer:e.dialogVideoPlayer,videoUrl:e.videoUrl}})],2)},n=[],i=(a("d81d"),a("ac1f"),a("841c"),a("1276"),a("96cf"),a("1da1")),s=a("c276"),o=a("365c"),l=a("099f"),u=a("77ec"),m=a("a269"),c=a("32fb"),d=a("b017"),p=a("7847"),g=a("a880"),f=a("1bdc"),h={name:"fixedAssetManagement-itemManagement",components:{showNewItem:l["default"],showDamageItem:u["default"],applyNewItem:m["default"],damageItemReport:c["default"],addNewItem:d["default"],changeItem:p["default"],itemTable:g["default"],videoPlayer:f["default"]},data:function(){return{tableData:[],randomKey:0,drawerNewItemArouseChangesNumber:0,drawerOldItemArouseChangesNumber:0,dialogNewItemArouseChangesNumber:0,dialogOldItemArouseChangesNumber:0,oldItemId_Name:{},addNewItemArouseChangesNumber:0,dialogChangeItemArouseChangesNumber:0,dialogVideoPlayer:0,videoUrl:"",changeItemInformation:{},inputSearch:"",pagination:{currentPage:1,pageSize:10,allPage:1,allData:1},loadAnimation:!0,userAdministratorPermissions:"0"===s["a"].cookies.get("userStatus")||!1}},methods:{handleSizeChange:function(e){this.pagination.pageSize=e,this.pagination.currentPage=1,this.itemSearch({page:1,pageSize:this.pagination.pageSize,search:this.inputSearch})},handleCurrentChange:function(e){this.pagination.currentPage=e,this.itemSearch({page:e,pageSize:this.pagination.pageSize,search:this.inputSearch})},inputFocus:function(e){this.$refs[e].select()},searchEnter:function(e){this.$refs[e].blur()},showImgAPI:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["a"].SHOW_IMG_API(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},itemSearchAPI:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.page,r=e.pageSize,n=e.search,t.next=3,o["a"].ITEM_SEARCH_API({page:a,pageSize:r,search:n});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},itemSearch:function(e){var t=this,a=e.page,r=void 0===a?1:a,n=e.pageSize,i=void 0===n?10:n,s=e.search;this.itemSearchAPI({page:r,pageSize:i,search:s}).then((function(e){if("fail"===e)return t.loadAnimation=!1,t.$message.error("获取失败");if(e.status>=4e4)return t.$log.push({message:"错误代码:"+e.status+","+e.message,type:"warning"}),t.$notify({title:e.message,message:"错误代码:"+e.status,position:"bottom-left",type:"warning"});t.tableData=JSON.parse(JSON.stringify(e.items));for(var a=function(e){t.tableData[e].img="",""!==t.tableData[e].imgs?(t.tableData[e].urlSave=t.tableData[e].imgs,t.showImgAPI(t.tableData[e].imgs).then((function(a){t.tableData[e].imgs=a}))):(t.tableData[e].urlSave=t.tableData[e].videos,t.showImgAPI(t.tableData[e].videos).then((function(a){t.tableData[e].videos=a})))},r=0;r<t.tableData.length;r++)a(r);t.pagination.allPage=e.totalPage,t.pagination.allData=e.total,t.loadAnimation=!1}))},dialogOldItem:function(e,t){var a=e.itemId,r=e.itemName,n=e.number;this.oldItemId_Name={itemId:a,itemName:r,number:n},t&&this.dialogOldItemArouseChangesNumber++},dialogChangeItem:function(e){this.changeItemInformation=e,this.dialogChangeItemArouseChangesNumber++},changeItemSuccess:function(e){var t=this,a=this.tableData,r=null;this.tableData.map((function(t,n){t.itemId===e.itemId&&(a[n]=e,r=n)})),"http:"!==e.imgs.split("/")[0]&&"https:"!==e.imgs.split("/")[0]&&"http:"!==e.videos.split("/")[0]&&"https:"!==e.videos.split("/")[0]||(""!==a[r].imgs?this.showImgAPI(a[r].imgs).then((function(e){a[r].imgs=e,t.tableData=a})):this.showImgAPI(a[r].videos).then((function(e){a[r].videos=e,t.tableData=a}))),this.randomKey=Math.random()},deleteInformation:function(e){var t=this;if(!e)return 0;this.loadAnimation=!0,clearTimeout(this.timeout),this.timeout=setTimeout((function(){t.itemSearch({page:t.pagination.currentPage,pageSize:t.pagination.pageSize,search:t.inputSearch})}),10)},dialogVideoPlayerArouse:function(e){this.videoUrl=e,this.dialogVideoPlayer++},addSuccess:function(){this.itemSearch({page:this.pagination.currentPage,pageSize:this.pagination.pageSize,search:this.inputSearch})}},mounted:function(){this.itemSearch({page:1,pageSize:10,search:""})}},b=h,w=(a("6351"),a("2877")),y=Object(w["a"])(b,r,n,!1,null,"427815c6",null);t["default"]=y.exports},"32fb":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"物品损坏上报",visible:e.dialogVisible,"before-close":e.handleClose,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("span",[a("b",[e._v(e._s(e.oldItemId_Name.itemName))])]),a("br"),a("br"),a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"损坏数量",prop:"number"}},[a("el-input",{attrs:{type:"number",controls:!1,size:"mini",min:"1",max:e.oldItemId_Name.number},model:{value:e.ruleForm.number,callback:function(t){e.$set(e.ruleForm,"number",e._n(t))},expression:"ruleForm.number"}})],1),a("el-form-item",{attrs:{label:"损坏详情",prop:"inputText"}},[a("el-input",{attrs:{type:"textarea"},on:{blur:e.textProcessing},model:{value:e.ruleForm.inputText,callback:function(t){e.$set(e.ruleForm,"inputText",t)},expression:"ruleForm.inputText"}})],1),a("el-form-item",{attrs:{label:"上传图片",prop:"img"}},[a("el-upload",{ref:"imgLoad",attrs:{drag:"",action:"",multiple:"",accept:".png, .jpg, jpeg",limit:5,"list-type":"picture","on-change":e.change,"on-exceed":e.handleExceed,"auto-upload":!1}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传5张jpg/png文件")])])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.buttonLoading},on:{click:e.submit}},[e._v("确 定")])],1)],1)},n=[],i=(a("4160"),a("c975"),a("a15b"),a("b0c0"),a("a9e3"),a("d3b7"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("1276"),a("159b"),a("96cf"),a("1da1")),s=a("c276"),o=a("365c"),l=a("5a0c"),u={name:"damageItemReport",props:{dialogArouse:{type:Number,required:!0},oldItemId_Name:{type:Object,required:!0}},data:function(){return{ruleForm:{number:1,inputText:"",imgUrls:"",img:[]},rules:{number:[{required:!0,message:"请输入损坏数量",trigger:"blur"},{required:!0,type:"number",min:1,max:this.oldItemId_Name.number,message:"请输入正确损坏数量",trigger:"blur"}],inputText:[{required:!0,message:"请输入损坏详情",trigger:"blur"}],img:[{required:!0,message:"上传损坏图片",trigger:"blur"}]},imgUrlData:["","","","",""],buttonLoading:!1,dialogVisible:!1}},watch:{dialogArouse:function(){"itemId"in this.oldItemId_Name?this.dialogVisible=!0:this.$message.error("当前未选中任何物品")}},methods:{dialogArouseOperate:function(){this.dialogVisible=!0},handleClose:function(e){var t=this;this.$confirm("确认关闭？").then((function(a){t.ruleForm={number:1,inputText:"",imgUrls:"",img:[]},t.$refs.ruleForm.clearValidate(),t.$refs.imgLoad.clearFiles(),e()})).catch((function(e){}))},handleExceed:function(e,t){this.$message.error("最多上传5张图片")},beforeUpload:function(e){var t=e.name.replace(/.+\./,""),a=e.size/1024/1024<=10,r=-1===["png","jpg","jpeg"].indexOf(t.toLowerCase());return r?(this.$message({type:"warning",message:"只能上传 .png, .jpg, .jpeg 文件！"}),this.$refs.img.clearFiles(),!1):!!a||(this.$message({type:"warning",message:"附件大小超限，文件不能超过 10M"}),this.$refs.img.clearFiles(),!1)},previewFile:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=new Blob([e],{type:e.type}),s=null,e&&(s=new FileReader,s.readAsDataURL(n)),s.onload=Object(i["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=a.imageCompression(s.result),e.next=3,r.then((function(e){return t.push(e),Promise.resolve(e)}));case 3:a.ruleForm.imgBase64=t;case 4:case"end":return e.stop()}}),e)})));case 4:case"end":return r.stop()}}),r)})))()},pImg:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){e.onload=function(){var a=parseInt(e.width)/parseInt(e.height);t(a)}})));case 1:case"end":return t.stop()}}),t)})))()},pCanvas:function(e,t,a,r){return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,i){r.drawImage(e,0,0,t,1e3);var s=a.toDataURL();n(s)})));case 1:case"end":return n.stop()}}),n)})))()},imageCompression:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n,i,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=new Image,n=document.createElement("canvas"),i=n.getContext("2d"),r.src=e,a.next=6,t.pImg(r);case 6:return s=a.sent,n.width=1e3*s,n.height=1e3,a.next=11,t.pCanvas(r,1e3*s,n,i);case 11:return a.abrupt("return",a.sent);case 12:case"end":return a.stop()}}),a)})))()},itemReportDamagedAPI:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,n,i,s,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.username,r=e.itemId,n=e.itemName,i=e.inputText,s=e.imgUrls,l=e.damageRecordTime,t.next=3,o["a"].ITEM_REPORT_DAMAGED_API({username:a,itemId:r,itemName:n,damageRecordDesc:i,damageRecordImg:s,damageRecordTime:l});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},itemReportDamaged:function(e){var t=this,a=e.itemId,r=e.itemName,n=e.inputText,i=e.number,o=e.imgUrls,u=s["a"].cookies.get("username"),m=l().format("YYYY-MM-DD");n=n+"//////////"+i,this.itemReportDamagedAPI({username:u,itemId:a,itemName:r,inputText:n,imgUrls:o,damageRecordTime:m}).then((function(e){if(null===e)t.$message({message:"上传成功",type:"success"}),t.ruleForm={number:1,inputText:"",imgUrls:"",img:[]},t.$refs.ruleForm.clearValidate(),t.$refs.imgLoad.clearFiles(),t.dialogVisible=!1,t.buttonLoading=!1;else if("fail"===e)t.$message.error("上传失败"),t.buttonLoading=!1,t.imgUrlData=["","","","",""];else if(e.status>=4e4)return t.imgUrlData=["","","","",""],t.$log.push({message:"错误代码:"+e.status+","+e.message,type:"warning"}),t.$notify({title:e.message,message:"错误代码:"+e.status,position:"bottom-left",type:"warning"})}))},imgUploadAPI:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["a"].ITEM_DAMAGE_IMG_UPLOAD_API(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},imgUpload:function(e,t){var a=this,r=new FormData;r.append("file",new Blob([e.raw],{type:e.raw.type})),this.buttonLoading=!0,this.imgUploadAPI(r).then((function(e){if("http:"===e.split("/")[0]||"https:"===e.split("/")[0]){a.imgUrlData[t]=e;for(var r=[],n=0;n<a.ruleForm.img.length;n++){if(""===a.imgUrlData[n])return;r.push(a.imgUrlData[n])}a.ruleForm.imgUrls=r.join("//////////"),a.itemReportDamaged({itemId:a.oldItemId_Name.itemId,itemName:a.oldItemId_Name.itemName,inputText:a.ruleForm.inputText,imgUrls:a.ruleForm.imgUrls,number:a.ruleForm.number})}else if("fail"===e)a.$message.error("上传失败"),a.buttonLoading=!1,a.imgUrlData=["","","","",""];else if(e.status>=4e4)return a.imgUrlData=["","","","",""],a.$log.push({message:"错误代码:"+e.status+","+e.message,type:"warning"}),a.$notify({title:e.message,message:"错误代码:"+e.status,position:"bottom-left",type:"warning"})}))},textProcessing:function(){var e=new RegExp("/","g"),t=this.ruleForm.inputText.replace(e,"");this.ruleForm.inputText=t},change:function(e,t){this.beforeUpload(e,t)&&(this.ruleForm.img=t)},submit:function(){var e=this;this.$refs.ruleForm.validate((function(t){t?(e.ruleForm.imgUrls="",e.ruleForm.img.forEach((function(t,a){e.imgUpload(t,a)}))):e.$message.error("表单校验失败，请检查")}))}}},m=u,c=a("2877"),d=Object(c["a"])(m,r,n,!1,null,"5272e589",null);t["default"]=d.exports},"4d63":function(e,t,a){var r=a("83ab"),n=a("da84"),i=a("94ca"),s=a("7156"),o=a("9bf2").f,l=a("241c").f,u=a("44e7"),m=a("ad6d"),c=a("9f7f"),d=a("6eeb"),p=a("d039"),g=a("69f3").set,f=a("2626"),h=a("b622"),b=h("match"),w=n.RegExp,y=w.prototype,v=/a/g,I=/a/g,D=new w(v)!==v,A=c.UNSUPPORTED_Y,x=r&&i("RegExp",!D||A||p((function(){return I[b]=!1,w(v)!=v||w(I)==I||"/a/i"!=w(v,"i")})));if(x){var _=function(e,t){var a,r=this instanceof _,n=u(e),i=void 0===t;if(!r&&n&&e.constructor===_&&i)return e;D?n&&!i&&(e=e.source):e instanceof _&&(i&&(t=m.call(e)),e=e.source),A&&(a=!!t&&t.indexOf("y")>-1,a&&(t=t.replace(/y/g,"")));var o=s(D?new w(e,t):w(e,t),r?this:y,_);return A&&a&&g(o,{sticky:a}),o},R=function(e){e in _||o(_,e,{configurable:!0,get:function(){return w[e]},set:function(t){w[e]=t}})},F=l(w),P=0;while(F.length>P)R(F[P++]);y.constructor=_,_.prototype=y,d(n,"RegExp",_)}f("RegExp")},6351:function(e,t,a){"use strict";var r=a("c3b6"),n=a.n(r);n.a},"77ec":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-drawer",{attrs:{title:"物品损坏上报信息",visible:e.drawerVisible,size:"80%",direction:"btt"},on:{"update:visible":function(t){e.drawerVisible=t}}},[a("el-radio-group",{style:{marginLeft:"16px"},attrs:{size:"small"},on:{input:e.radioChange},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[a("el-radio-button",{attrs:{label:"待处理"}}),a("el-radio-button",{attrs:{label:"已处理"}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadAnimation,expression:"loadAnimation"}],key:e.randomKey,staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":"没有物品损坏或已全部完成处理"}},[a("el-table-column",{attrs:{prop:"damageRecordTime",label:"损坏日期",width:"140"}}),e.userAdministratorPermissions?a("el-table-column",{attrs:{prop:"username",label:"上报人",width:"140"}}):e._e(),a("el-table-column",{attrs:{prop:"itemName",label:"损坏物品",width:"140"}}),a("el-table-column",{attrs:{prop:"number",label:"损坏数量",width:"120"}}),a("el-table-column",{attrs:{prop:"damageRecordImgs",label:"图片",width:"360"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{attrs:{gutter:20}},e._l(t.row.imgs,(function(e,t){return a("el-col",{key:t,attrs:{span:4}},[a("el-popover",{staticClass:"images",attrs:{placement:"top",title:"",trigger:"hover"}},[a("img",{staticStyle:{height:"400px"},attrs:{src:e,alt:""}}),a("el-image",{staticStyle:{height:"40px"},attrs:{slot:"reference",src:e,"preview-src-list":[e]},slot:"reference"},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])])],1)],1)})),1)]}}])}),a("el-table-column",{attrs:{prop:"damageRecordDesc",label:"描述"}}),e.userAdministratorPermissions?a("el-table-column",{attrs:{label:"操作",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return["待处理"===e.radio?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.finishDamageInformation(t.row)}}},[e._v("完成处理")]):e._e(),"已处理"===e.radio?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.deleteDamageInformation(t.row)}}},[e._v("删除")]):e._e()]}}],null,!1,1823416659)}):e._e()],1)],1)},n=[],i=(a("4de4"),a("a9e3"),a("ac1f"),a("3ca3"),a("1276"),a("ddb0"),a("96cf"),a("1da1")),s=a("365c"),o=a("c276"),l={name:"showDamageItem",props:{drawerArouse:{type:Number,required:!0}},data:function(){return{tableData:[{damageRecordId:1,damageRecordDesc:"桌腿坏了",damageRecordTime:"2023-5-5",itemName:"桌子",username:"王五",damageRecordImg:"",imgs:[],damageRecordIsHandle:!1}],allTableData:{tableDataWait:[],tableDataFinish:[]},radio:"待处理",randomKey:Math.random(),loadAnimation:!1,drawerVisible:!1,userAdministratorPermissions:"0"===o["a"].cookies.get("userStatus")||!1}},watch:{drawerArouse:function(){this.loadAnimation=!0,this.userAdministratorPermissions&&this.itemSearchDamage({username:null}),this.userAdministratorPermissions||this.itemSearchDamage({username:o["a"].cookies.get("username")}),this.drawerVisible=!0},drawerVisible:function(){this.radio="待处理"}},methods:{handleClick:function(e){this.$emit("dialogChangeItem",e)},radioChange:function(e){var t=this;clearTimeout(this.radioChange_timeout),this.radio=e,this.loadAnimation=!0,this.radioChange_timeout=setTimeout((function(){"待处理"===t.radio?t.tableData=t.allTableData.tableDataWait:t.tableData=t.allTableData.tableDataFinish,t.loadAnimation=!1}),300)},showImgAPI:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].SHOW_IMG_API(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},itemSearchDamageAPI:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.username,null!==a){t.next=5;break}return t.next=4,s["a"].ITEM_SEARCH_DAMAGED_API();case 4:return t.abrupt("return",t.sent);case 5:if("string"!==typeof a){t.next=9;break}return t.next=8,s["a"].ITEM_SEARCH_DAMAGED_API({username:a});case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))()},itemSearchDamage:function(e){var t=this,a=e.username,r=void 0===a?null:a;this.itemSearchDamageAPI({username:r}).then(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(a){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("fail"!==a){e.next=5;break}return t.loadAnimation=!1,e.abrupt("return",t.$message.error("信息获取失败"));case 5:if(!(a.status>=4e4)){e.next=9;break}return t.loadAnimation=!1,t.$log.push({message:"错误代码:"+a.status+","+a.message,type:"warning"}),e.abrupt("return",t.$notify({title:a.message,message:"错误代码:"+a.status,position:"bottom-left",type:"warning"}));case 9:r=regeneratorRuntime.mark((function e(r){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a[r].imgs=a[r].damageRecordImg.split("//////////"),n=regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.showImgAPI(a[r].imgs[n]).then((function(e){a[r].imgs[n]=e}));case 2:case"end":return e.stop()}}),e)})),i=0;case 3:if(!(i<a[r].imgs.length)){e.next=8;break}return e.delegateYield(n(i),"t0",5);case 5:i++,e.next=3;break;case 8:case"end":return e.stop()}}),e)})),n=0;case 11:if(!(n<a.length)){e.next=16;break}return e.delegateYield(r(n),"t0",13);case 13:n++,e.next=11;break;case 16:return e.next=18,a.filter((function(e,t){if(!1===e.damageRecordIsHandle)return e.number=e.damageRecordDesc.split("//////////")[1],e.damageRecordDesc=e.damageRecordDesc.split("//////////")[0],e}));case 18:return t.allTableData.tableDataWait=e.sent,e.next=21,a.filter((function(e,t){if(!0===e.damageRecordIsHandle)return e.number=e.damageRecordDesc.split("//////////")[1],e.damageRecordDesc=e.damageRecordDesc.split("//////////")[0],e}));case 21:t.allTableData.tableDataFinish=e.sent,"待处理"===t.radio?t.tableData=t.allTableData.tableDataWait:t.tableData=t.allTableData.tableDataFinish,t.loadAnimation=!1;case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},itemDeleteDamageAPI:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.id,t.next=3,s["a"].ITEM_DELETE_DAMAGED_API({id:a});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},itemDeleteDamage:function(e){var t=this,a=e.id;this.itemDeleteDamageAPI({id:a}).then((function(e){if(null===e)t.$message({message:"删除成功",type:"success"}),t.itemSearchDamage({username:null});else if("fail"===e)t.$message.error("删除失败");else if(e.status>=4e4)return t.$log.push({message:"错误代码:"+e.status+","+e.message,type:"warning"}),t.$notify({title:e.message,message:"错误代码:"+e.status,position:"bottom-left",type:"warning"})}))},itemFinishDamageAPI:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.id,t.next=3,s["a"].ITEM_FINISH_DAMAGED_API({id:a});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},itemFinishDamage:function(e){var t=this,a=e.id;this.itemFinishDamageAPI({id:a}).then((function(e){if(null===e)t.$message({message:"处理成功",type:"success"}),t.itemSearchDamage({username:null});else if("fail"===e)t.$message.error("处理失败");else if(e.status>=4e4)return t.$log.push({message:"错误代码:"+e.status+","+e.message,type:"warning"}),t.$notify({title:e.message,message:"错误代码:"+e.status,position:"bottom-left",type:"warning"})}))},finishDamageInformation:function(e){this.itemFinishDamage({id:e.damageRecordId})},deleteDamageInformation:function(e){this.itemDeleteDamage({id:e.damageRecordId})}}},u=l,m=a("2877"),c=Object(m["a"])(u,r,n,!1,null,"bc528432",null);t["default"]=c.exports},a269:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"新物品购置资金申请",visible:e.dialogVisible,"before-close":e.handleClose,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"itemName"}},[a("el-input",{attrs:{type:"text"},model:{value:e.ruleForm.itemName,callback:function(t){e.$set(e.ruleForm,"itemName",t)},expression:"ruleForm.itemName"}})],1),a("el-form-item",{attrs:{label:"数量",prop:"number"}},[a("el-input",{attrs:{type:"number",controls:!1,size:"mini",min:"1"},model:{value:e.ruleForm.number,callback:function(t){e.$set(e.ruleForm,"number",e._n(t))},expression:"ruleForm.number"}})],1),a("el-form-item",{attrs:{label:"总金额",prop:"price"}},[a("el-input",{attrs:{type:"number",controls:!1,size:"mini",min:.01,step:.01,precision:"2"},model:{value:e.ruleForm.price,callback:function(t){e.$set(e.ruleForm,"price",e._n(t))},expression:"ruleForm.price"}})],1),a("el-form-item",{attrs:{label:"详情",prop:"description"}},[a("el-input",{attrs:{type:"textarea"},on:{blur:e.textProcessing},model:{value:e.ruleForm.description,callback:function(t){e.$set(e.ruleForm,"description",t)},expression:"ruleForm.description"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)},n=[],i=(a("a4d3"),a("e01a"),a("b0c0"),a("a9e3"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("53ca")),s=(a("96cf"),a("1da1")),o=a("365c"),l=a("5a0c"),u=a.n(l),m=a("c276"),c={name:"applyNewItem",props:{dialogArouse:{type:Number,required:!0}},data:function(){return{ruleForm:{itemName:"",number:1,price:null,description:""},rules:{itemName:[{required:!0,message:"请输入物品名",trigger:"blur"},{required:!0,pattern:/^[\u4e00-\u9fa5_a-zA-Z0-9\s*.·-]+$/,message:"不支持特殊字符",trigger:"blur"}],number:[{required:!0,message:"请输入数量",trigger:"blur"},{required:!0,pattern:/^[0-9|^\\.]/,message:"不能为负",trigger:"blur"}],price:[{required:!0,message:"请输入总金额",trigger:"blur"},{required:!0,pattern:/^[0-9|^\\.]/,message:"不能为负",trigger:"blur"},{required:!0,pattern:/(^[1-9](\d+)?(\.\d{1,2})?$)|(^0$)|(^\d\.\d{1,2}$)/,message:"请输入正确格式",trigger:"blur"}],description:[{required:!0,message:"说明一下",trigger:"blur"}]},dialogVisible:!1}},watch:{dialogArouse:function(){this.dialogVisible=!0}},methods:{handleClose:function(e){this.$confirm("确认关闭？").then((function(t){e()})).catch((function(e){}))},textProcessing:function(){var e=new RegExp("/","g"),t=this.ruleForm.description.replace(e,"");this.ruleForm.description=t},itemApplyAPI:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.content,r=e.money,n=e.applyTime,i=e.name,t.next=3,o["a"].ITEM_APPLY_API({content:a,money:r,applyTime:n,name:i});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},itemApply:function(e){var t=this,a=e.content,r=e.money;this.itemApplyAPI({content:a,money:r,applyTime:u()().format("YYYY-MM-DD HH:mm:ss"),name:m["a"].cookies.get("name")}).then((function(e){"object"===Object(i["a"])(e)?(t.ruleForm={itemName:"",number:1,price:null,description:""},t.$message({message:"上传成功",type:"success"}),t.dialogVisible=!1):t.$message.error("请求发送失败")}))},submit:function(){var e=this;this.textProcessing(),this.$refs.ruleForm.validate((function(t){if(t){var a=e.ruleForm.itemName+"//////////"+e.ruleForm.number+"//////////"+e.ruleForm.description;e.itemApply({content:a,money:e.ruleForm.price})}else e.$message.error("表单校验失败，请检查")}))}}},d=c,p=a("2877"),g=Object(p["a"])(d,r,n,!1,null,"1d005442",null);t["default"]=g.exports},a880:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadAnimation,expression:"loadAnimation"}],key:e.randomKey,staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",height:"100%",data:e.tableData},on:{"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{prop:"itemName",label:"物品",width:"300"}}),a("el-table-column",{attrs:{label:"视频图片",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!==t.row.imgs&&""!==t.row.imgs?a("el-popover",{attrs:{placement:"right",trigger:"hover"}},[a("img",{staticStyle:{height:"300px"},attrs:{src:t.row.imgs,alt:""}}),a("el-image",{staticStyle:{height:"35px"},attrs:{slot:"reference",src:t.row.imgs,"preview-src-list":[t.row.imgs]},slot:"reference"},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])])],1):e._e(),null!==t.row.videos&&""!==t.row.videos?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.dialogVideoPlayer(t.row.videos)}}},[e._v("查看视频")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"number",label:"数量",width:"120"}}),a("el-table-column",{attrs:{prop:"price",label:"单价(元)",width:"120"}}),a("el-table-column",{attrs:{prop:"description",label:"描述"}}),a("el-table-column",{attrs:{label:"操作",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.userAdministratorPermissions?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleClick(t.row)}}},[e._v("修改")]):e._e(),e.userAdministratorPermissions?a("el-popover",{ref:"popover-"+t.$index,staticStyle:{"margin-left":"5px"},attrs:{placement:"top",title:"确认删除?",width:"160",trigger:"click"}},[a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.deleteOperation(t.row,!1)}}},[e._v("取消")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.deleteOperation(t.row,!0)}}},[e._v("删除")])],1),a("el-button",{attrs:{slot:"reference",type:"text",size:"small"},slot:"reference"},[e._v("删除")])],1):e._e(),e.userAdministratorPermissions?e._e():a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.dialogOldItemArouse(t.row)}}},[e._v("问题上报")])]}}])})],1)},n=[],i=(a("96cf"),a("1da1")),s=a("c276"),o=a("365c"),l={name:"itemTable",props:{tableData:{required:!0},randomKey:{required:!0},loadAnimation:{required:!0}},data:function(){return{currentlySelected:{},userAdministratorPermissions:"0"===s["a"].cookies.get("userStatus")||!1}},methods:{handleClick:function(e){this.$emit("dialogChangeItem",e)},handleCurrentChange:function(e){null!==e&&(this.currentlySelected=e,this.$emit("dialogOldItem",{itemId:e.itemId,itemName:e.itemName,number:e.number},!1))},dialogOldItemArouse:function(e){this.$emit("dialogOldItem",{itemId:e.itemId,itemName:e.itemName,number:e.number},!0)},itemDeleteAPI:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.id,t.next=3,o["a"].ITEM_DELETE_API({id:a});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},itemDelete:function(e){var t=this,a=e.id;this.itemDeleteAPI({id:a}).then((function(e){if(null===e)t.$message({message:"删除成功",type:"success"});else if("fail"===e)t.$message.error("删除失败");else if(e.status>=4e4)return t.$log.push({message:"错误代码:"+e.status+","+e.message,type:"warning"}),t.$notify({title:e.message,message:"错误代码:"+e.status,position:"bottom-left",type:"warning"})}))},deleteOperation:function(e,t){document.body.click(),t&&(this.itemDelete({id:e.itemId}),this.$emit("deleteInformation",!0))},dialogVideoPlayer:function(e){this.$emit("dialogVideoPlayerArouse",e)}}},u=l,m=a("2877"),c=Object(m["a"])(u,r,n,!1,null,"38626fc8",null);t["default"]=c.exports},b017:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"新物品添加",visible:e.dialogVisible,"before-close":e.handleClose,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"itemName"}},[a("el-input",{attrs:{type:"text",controls:!1},model:{value:e.ruleForm.itemName,callback:function(t){e.$set(e.ruleForm,"itemName",t)},expression:"ruleForm.itemName"}})],1),a("el-form-item",{attrs:{label:"数量",prop:"number"}},[a("el-input",{attrs:{type:"number",controls:!1,size:"mini",min:"1"},model:{value:e.ruleForm.number,callback:function(t){e.$set(e.ruleForm,"number",e._n(t))},expression:"ruleForm.number"}})],1),a("el-form-item",{attrs:{label:"单价金额",prop:"price"}},[a("el-input",{attrs:{type:"number",controls:!1,size:"mini",min:.01,step:.01,precision:"2"},model:{value:e.ruleForm.price,callback:function(t){e.$set(e.ruleForm,"price",e._n(t))},expression:"ruleForm.price"}})],1),a("el-form-item",{attrs:{label:"详情",prop:"description"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.description,callback:function(t){e.$set(e.ruleForm,"description",t)},expression:"ruleForm.description"}})],1),a("el-form-item",{attrs:{label:"视频图片",prop:"img"}},[a("el-upload",{ref:"img",attrs:{drag:"",action:"",accept:".png, .jpg, .jpeg, .mp4, .flv",limit:1,"list-type":"text","on-change":e.change,"on-exceed":e.handleExceed,"auto-upload":!1}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传一个图片或视频文件")])])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.buttonLoading},on:{click:e.submit}},[e._v("确 定")])],1)],1)},n=[],i=(a("a4d3"),a("e01a"),a("c975"),a("b0c0"),a("a9e3"),a("d3b7"),a("ac1f"),a("5319"),a("1276"),a("96cf"),a("1da1")),s=a("365c"),o={name:"addNewItem",props:{dialogArouse:{type:Number,required:!0}},data:function(){return{ruleForm:{itemName:"",number:1,price:null,description:"",img:"",imgs:"",videos:""},imgType:null,rules:{itemName:[{required:!0,message:"请输入物品名",trigger:"blur"},{required:!0,pattern:/^[\u4e00-\u9fa5_a-zA-Z0-9\s*.·-]+$/,message:"不支持特殊字符",trigger:"blur"}],number:[{required:!0,message:"请输入数量",trigger:"blur"},{required:!0,pattern:/^[0-9|^\\.]/,message:"不能为负",trigger:"blur"}],price:[{required:!0,message:"请输入单价金额",trigger:"blur"},{required:!0,pattern:/^[0-9|^\\.]/,message:"不能为负",trigger:"blur"},{required:!0,pattern:/(^[1-9](\d+)?(\.\d{1,2})?$)|(^0$)|(^\d\.\d{1,2}$)/,message:"请输入正确格式",trigger:"blur"}],description:[{required:!0,message:"说明一下",trigger:"blur"}],img:[{required:!0,message:"上传视频或图片",trigger:"blur"}]},buttonLoading:!1,dialogVisible:!1}},watch:{dialogArouse:function(){this.dialogVisible=!0}},methods:{handleClose:function(e){var t=this;this.$confirm("确认关闭？").then((function(a){t.ruleForm={itemName:"",number:1,price:null,description:"",img:""},t.$refs.ruleForm.clearValidate(),t.$refs.img.clearFiles(),e()})).catch((function(e){}))},handleExceed:function(e,t){this.$message.error("最多上传1张图片")},beforeUpload:function(e){var t=e.name.replace(/.+\./,""),a=e.size/1024/1024<=30,r=-1===["png","jpg","jpeg","mp4","flv"].indexOf(t.toLowerCase());return r?(this.$message({type:"warning",message:"只能上传 .png, .jpg, .jpeg, .mp4, .flv 文件！"}),this.$refs.img.clearFiles(),!1):!!a||(this.$message({type:"warning",message:"附件大小超限，文件不能超过 30M"}),this.$refs.img.clearFiles(),!1)},previewFile:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r=new Blob([e],{type:e.type}),n=null,e&&(n=new FileReader,n.readAsDataURL(r)),n.onload=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.ruleForm.img=n.result;case 1:case"end":return e.stop()}}),e)})));case 4:case"end":return a.stop()}}),a)})))()},pImg:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){e.onload=function(){var a=parseInt(e.width)/parseInt(e.height);t(a)}})));case 1:case"end":return t.stop()}}),t)})))()},pCanvas:function(e,t,a,r){return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,i){r.drawImage(e,0,0,t,500);var s=a.toDataURL();n(s)})));case 1:case"end":return n.stop()}}),n)})))()},imageCompression:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n,i,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=new Image,n=document.createElement("canvas"),i=n.getContext("2d"),r.src=e,a.next=6,t.pImg(r);case 6:return s=a.sent,n.width=500*s,n.height=500,a.next=11,t.pCanvas(r,500*s,n,i);case 11:return a.abrupt("return",a.sent);case 12:case"end":return a.stop()}}),a)})))()},itemAddAPI:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,n,i,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.itemName,r=e.number,n=e.price,i=e.description,o=e.imgs,l=e.videos,t.next=3,s["a"].ITEM_ADD_API({itemName:a,number:r,price:n,description:i,imgs:o,videos:l});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},itemAdd:function(e){var t=this,a=e.itemName,r=e.number,n=e.price,i=e.description,s=e.imgs,o=e.videos;this.itemAddAPI({itemName:a,number:r,price:n,description:i,imgs:s,videos:o}).then((function(e){if(null===e)t.$message({message:"上传成功",type:"success"}),t.ruleForm={itemName:"",number:1,price:null,description:"",imgs:"",videos:""},t.$refs.ruleForm.clearValidate(),t.$refs.img.clearFiles(),t.dialogVisible=!1,t.buttonLoading=!1,t.$emit("addSuccess");else if("fail"===e)t.$message.error("上传失败"),t.buttonLoading=!1;else if(e.status>=4e4)return t.$log.push({message:"错误代码:"+e.status+","+e.message,type:"warning"}),t.$notify({title:e.message,message:"错误代码:"+e.status,position:"bottom-left",type:"warning"})}))},imgUploadAPI:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].ITEM_IMG_UPLOAD_API(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},imgUpload:function(e){var t=this,a=new FormData;a.append("file",new Blob([e.raw],{type:e.raw.type})),this.buttonLoading=!0,this.imgUploadAPI(a).then((function(e){if("http:"===e.split("/")[0]||"https:"===e.split("/")[0])"image"===t.imgType?(t.ruleForm.imgs=e,t.ruleForm.videos=""):"video"===t.imgType&&(t.ruleForm.imgs="",t.ruleForm.videos=e),t.itemAdd({itemName:t.ruleForm.itemName,number:t.ruleForm.number,price:t.ruleForm.price,description:t.ruleForm.description,imgs:t.ruleForm.imgs,videos:t.ruleForm.videos});else if("fail"===e)t.$message.error("上传失败 || 返回数据有误"),t.buttonLoading=!1;else if(e.status>=4e4)return t.$log.push({message:"错误代码:"+e.status+","+e.message,type:"warning"}),t.$notify({title:e.message,message:"错误代码:"+e.status,position:"bottom-left",type:"warning"})}))},change:function(e,t){this.beforeUpload(e,t)&&(this.ruleForm.img=e,"image"===e.raw.type.split("/")[0]?this.imgType="image":"video"===e.raw.type.split("/")[0]&&(this.imgType="video"))},submit:function(){var e=this;this.$refs.ruleForm.validate((function(t){t?e.imgUpload(e.ruleForm.img):e.$message.error("表单校验失败，请检查")}))}}},l=o,u=a("2877"),m=Object(u["a"])(l,r,n,!1,null,"69660350",null);t["default"]=m.exports},c3b6:function(e,t,a){}}]);