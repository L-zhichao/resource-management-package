(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f98c934"],{1276:function(e,t,r){"use strict";var i=r("d784"),n=r("44e7"),s=r("825a"),a=r("1d80"),o=r("4840"),l=r("8aa5"),u=r("50c4"),m=r("14c3"),c=r("9263"),g=r("d039"),p=[].push,d=Math.min,f=4294967295,h=!g((function(){return!RegExp(f,"y")}));i("split",2,(function(e,t,r){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var i=String(a(this)),s=void 0===r?f:r>>>0;if(0===s)return[];if(void 0===e)return[i];if(!n(e))return t.call(i,e,s);var o,l,u,m=[],g=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,h=new RegExp(e.source,g+"g");while(o=c.call(h,i)){if(l=h.lastIndex,l>d&&(m.push(i.slice(d,o.index)),o.length>1&&o.index<i.length&&p.apply(m,o.slice(1)),u=o[0].length,d=l,m.length>=s))break;h.lastIndex===o.index&&h.lastIndex++}return d===i.length?!u&&h.test("")||m.push(""):m.push(i.slice(d)),m.length>s?m.slice(0,s):m}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var n=a(this),s=void 0==t?void 0:t[e];return void 0!==s?s.call(t,n,r):i.call(String(n),t,r)},function(e,n){var a=r(i,e,this,n,i!==t);if(a.done)return a.value;var c=s(e),g=String(this),p=o(c,RegExp),b=c.unicode,v=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(h?"y":"g"),w=new p(h?c:"^(?:"+c.source+")",v),F=void 0===n?f:n>>>0;if(0===F)return[];if(0===g.length)return null===m(w,g)?[g]:[];var y=0,I=0,x=[];while(I<g.length){w.lastIndex=h?I:0;var $,C=m(w,h?g:g.slice(I));if(null===C||($=d(u(w.lastIndex+(h?0:I)),g.length))===y)I=l(g,I,b);else{if(x.push(g.slice(y,I)),x.length===F)return x;for(var _=1;_<=C.length-1;_++)if(x.push(C[_]),x.length===F)return x;I=y=$}}return x.push(g.slice(y)),x}]}),!h)},"286f":function(e,t,r){},"44e7":function(e,t,r){var i=r("861d"),n=r("c6b6"),s=r("b622"),a=s("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==n(e))}},7165:function(e,t,r){"use strict";var i=r("286f"),n=r.n(i);n.a},7847:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"修改物品",visible:e.dialogVisible,"before-close":e.handleClose,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"名称",prop:"itemName"}},[r("el-input",{attrs:{type:"text",controls:!1},model:{value:e.ruleForm.itemName,callback:function(t){e.$set(e.ruleForm,"itemName",t)},expression:"ruleForm.itemName"}})],1),r("el-form-item",{attrs:{label:"数量",prop:"number"}},[r("el-input",{attrs:{type:"number",controls:!1,size:"mini",min:"1"},model:{value:e.ruleForm.number,callback:function(t){e.$set(e.ruleForm,"number",e._n(t))},expression:"ruleForm.number"}})],1),r("el-form-item",{attrs:{label:"单价金额",prop:"price"}},[r("el-input",{attrs:{type:"number",controls:!1,size:"mini",min:.01,step:.01,precision:"2"},model:{value:e.ruleForm.price,callback:function(t){e.$set(e.ruleForm,"price",e._n(t))},expression:"ruleForm.price"}})],1),r("el-form-item",{attrs:{label:"详情",prop:"description"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.description,callback:function(t){e.$set(e.ruleForm,"description",t)},expression:"ruleForm.description"}})],1),e.oldImgView?r("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-between"}},[r("el-col",{attrs:{span:24}},[r("span",{staticClass:"spanText"},[e._v("原文件")]),r("el-popover",{attrs:{placement:"bottom",title:"",trigger:"hover",width:"175"}},[r("el-button",{staticClass:"buttonDeleteImg",attrs:{size:"medium",type:"danger",icon:"el-icon-delete",circle:""},on:{click:e.deleteOldImg}}),r("el-button",{attrs:{size:"medium",type:"success",plain:""},on:{click:e.whatButton}},[e._v("这是什么按钮")]),r("template",{slot:"reference"},[r("div",[""!==e.ruleForm.imgs&&null!==e.ruleForm.imgs?r("el-image",{staticStyle:{height:"100px"},attrs:{src:e.ruleForm.imgs,"preview-src-list":[e.ruleForm.imgs]}},[r("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[r("i",{staticClass:"el-icon-picture-outline"})])]):e._e(),""!==e.ruleForm.videos&&null!==e.ruleForm.videos?r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.dialogVideoPlayer(e.ruleForm.videos)}}},[e._v("查看视频")]):e._e()],1)])],2)],1)],1):e._e(),e.oldImgView?e._e():r("el-form-item",{attrs:{label:"视频图片",prop:"img"}},[r("el-upload",{ref:"img",attrs:{drag:"",action:"",accept:".png, .jpg, .jpeg, .mp4, .flv",limit:1,"list-type":"text","on-change":e.change,"on-exceed":e.handleExceed,"auto-upload":!1}},[r("i",{staticClass:"el-icon-upload"}),r("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),r("em",[e._v("点击上传")])]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传1一个图片或视频")])])],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",loading:e.buttonLoading},on:{click:e.submit}},[e._v("确 定")])],1)],1)},n=[],s=(r("a4d3"),r("e01a"),r("c975"),r("b0c0"),r("a9e3"),r("d3b7"),r("ac1f"),r("5319"),r("1276"),r("96cf"),r("1da1")),a=r("5530"),o=r("365c"),l={name:"changeItem",props:{dialogArouse:{type:Number,required:!0},changeItemInformation:{type:Object,required:!0}},data:function(){return{ruleForm:{itemId:0,itemName:"",number:1,price:null,description:"",img:"",imgs:"",videos:"",urlSave:""},imgType:null,rules:{itemName:[{required:!0,message:"请输入物品名",trigger:"blur"},{required:!0,pattern:/^[\u4e00-\u9fa5_a-zA-Z0-9\s*.·-]+$/,message:"不支持特殊字符",trigger:"blur"}],number:[{required:!0,message:"请输入数量",trigger:"blur"},{required:!0,pattern:/^[0-9|^\\.]/,message:"不能为负",trigger:"blur"}],price:[{required:!0,message:"请输入单价金额",trigger:"blur"},{required:!0,pattern:/^[0-9|^\\.]/,message:"不能为负",trigger:"blur"},{required:!0,pattern:/(^[1-9](\d+)?(\.\d{1,2})?$)|(^0$)|(^\d\.\d{1,2}$)/,message:"请输入正确格式",trigger:"blur"}],description:[{required:!0,message:"说明一下",trigger:"blur"}],img:[{required:!0,message:"上传视频或图片",trigger:"blur"}]},buttonLoading:!1,oldImgView:!0,dialogVisible:!1}},watch:{dialogArouse:function(){this.ruleForm=Object(a["a"])({},this.changeItemInformation),this.dialogVisible=!0}},methods:{whatButton:function(){for(var e=this,t=0;t<15;t++)setTimeout((function(){e.$notify({title:"这是一个绿色按钮",message:"就很想点一下,也不知道有什么用",type:"success"}),e.$notify({title:"这是一个绿色按钮",message:"就很想点一下,也不知道有什么用",position:"bottom-right",type:"success"}),e.$notify({title:"这是一个绿色按钮",message:"就很想点一下,也不知道有什么用",position:"bottom-left",type:"success"}),e.$notify({title:"这是一个绿色按钮",message:"就很想点一下,也不知道有什么用",position:"top-left",type:"success"})}),50*t);this.$log.push({message:"你点了一个绿色的、不知道有什么用的按钮!这将会发生什么?"})},handleClose:function(e){var t=this;this.$confirm("确认关闭？").then((function(r){t.ruleForm={itemId:0,itemName:"",number:1,price:null,description:"",img:"",imgs:"",videos:""},t.$refs.ruleForm.clearValidate(),!1===t.oldImgView&&(t.oldImgView=!0,t.$refs.img.clearFiles()),e()})).catch((function(e){}))},handleExceed:function(e,t){this.$message.error("最多上传1张图片")},beforeUpload:function(e){var t=e.name.replace(/.+\./,""),r=e.size/1024/1024<=30,i=-1===["png","jpg","jpeg","mp4","flv"].indexOf(t.toLowerCase());return i?(this.$message({type:"warning",message:"只能上传 .png, .jpg, .jpeg, .mp4, .flv 文件！"}),this.$refs.img.clearFiles(),!1):!!r||(this.$message({type:"warning",message:"附件大小超限，文件不能超过 30M"}),this.$refs.img.clearFiles(),!1)},deleteOldImg:function(){this.ruleForm.img="",this.ruleForm.imgs="",this.ruleForm.videos="",this.oldImgView=!1},previewFile:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var i,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:i=new Blob([e],{type:e.type}),n=null,e&&(n=new FileReader,n.readAsDataURL(i)),n.onload=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.ruleForm.imgs=n.result;case 1:case"end":return e.stop()}}),e)})));case 4:case"end":return r.stop()}}),r)})))()},pImg:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){e.onload=function(){var r=parseInt(e.width)/parseInt(e.height);t(r)}})));case 1:case"end":return t.stop()}}),t)})))()},pCanvas:function(e,t,r,i){return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,s){i.drawImage(e,0,0,t,500);var a=r.toDataURL();n(a)})));case 1:case"end":return n.stop()}}),n)})))()},imageCompression:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var i,n,s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return i=new Image,n=document.createElement("canvas"),s=n.getContext("2d"),i.src=e,r.next=6,t.pImg(i);case 6:return a=r.sent,n.width=500*a,n.height=500,r.next=11,t.pCanvas(i,500*a,n,s);case 11:return r.abrupt("return",r.sent);case 12:case"end":return r.stop()}}),r)})))()},itemChangeAPI:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,i,n,s,a,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.itemId,i=e.itemName,n=e.number,s=e.price,a=e.description,l=e.imgs,u=e.videos,t.next=3,o["a"].ITEM_CHANGE_API({itemId:r,itemName:i,number:n,price:s,description:a,imgs:l,videos:u});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},itemChange:function(e){var t=this,r=e.itemId,i=e.itemName,n=e.number,s=e.price,a=e.description,o=e.imgs,l=e.videos;this.itemChangeAPI({itemId:r,itemName:i,number:n,price:s,description:a,imgs:o,videos:l}).then((function(e){if(null===e)t.$message({message:"上传成功",type:"success"}),t.$emit("changeItemSuccess",t.ruleForm),t.ruleForm={itemId:0,itemName:"",number:1,price:null,description:"",img:"",imgs:"",videos:"",urlSave:""},t.$refs.ruleForm.clearValidate(),!1===t.oldImgView&&(t.oldImgView=!0,t.$refs.img.clearFiles()),t.buttonLoading=!1,t.dialogVisible=!1;else if("fail"===e)t.$message.error("上传失败"),t.buttonLoading=!1;else if(e.status>=4e4)return t.$log.push({message:"错误代码:"+e.status+","+e.message,type:"warning"}),t.$notify({title:e.message,message:"错误代码:"+e.status,position:"bottom-left",type:"warning"})}))},imgUploadAPI:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["a"].ITEM_IMG_UPLOAD_API(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},imgUpload:function(e){var t=this,r=new FormData;r.append("file",new Blob([e.raw],{type:e.raw.type})),this.buttonLoading=!0,this.imgUploadAPI(r).then((function(e){if("http:"===e.split("/")[0]||"https:"===e.split("/")[0])t.ruleForm.urlSave=e,"image"===t.imgType?(t.ruleForm.imgs=e,t.ruleForm.videos=""):"video"===t.imgType&&(t.ruleForm.imgs="",t.ruleForm.videos=e),t.itemChange({itemName:t.ruleForm.itemName,number:t.ruleForm.number,price:t.ruleForm.price,description:t.ruleForm.description,imgs:t.ruleForm.imgs,videos:t.ruleForm.videos});else if("fail"===e)t.$message.error("上传失败"),t.buttonLoading=!1;else if(e.status>=4e4)return t.$log.push({message:"错误代码:"+e.status+","+e.message,type:"warning"}),t.$notify({title:e.message,message:"错误代码:"+e.status,position:"bottom-left",type:"warning"})}))},change:function(e,t){this.beforeUpload(e,t)&&(this.ruleForm.img=e,"image"===e.raw.type.split("/")[0]?this.imgType="image":"video"===e.raw.type.split("/")[0]&&(this.imgType="video"))},submit:function(){var e=this;if(JSON.stringify(this.ruleForm)===JSON.stringify(this.changeItemInformation))return this.ruleForm={itemId:0,itemName:"",number:1,price:null,description:"",img:"",imgs:"",videos:"",url:""},this.buttonLoading=!1,this.$refs.ruleForm.clearValidate(),!1===this.oldImgView&&(this.oldImgView=!0,this.$refs.img.clearFiles()),void(this.dialogVisible=!1);this.$refs.ruleForm.validate((function(t){t?!0===e.oldImgView?e.itemChange({itemId:e.ruleForm.itemId,itemName:e.ruleForm.itemName,number:e.ruleForm.number,price:e.ruleForm.price,description:e.ruleForm.description,imgs:e.ruleForm.imgs&&e.ruleForm.urlSave,videos:e.ruleForm.videos&&e.ruleForm.urlSave}):e.imgUpload(e.ruleForm.img):e.$message.error("表单校验失败，请检查")}))},dialogVideoPlayer:function(e){this.$emit("dialogVideoPlayerArouse",e)}}},u=l,m=(r("7165"),r("2877")),c=Object(m["a"])(u,i,n,!1,null,"30ec1a86",null);t["default"]=c.exports}}]);